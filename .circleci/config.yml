version: 2.1

jobs:
  rails_test:
    parameters:
      parallelism:
        type: integer
        default: 2
    docker:
      -image: circleci/ruby:2.4
    parallelism: << parameters.parallelism >>
    steps: 
      - run : echo << parameters.parallelism >>
      
      
  rails_build:
    docker:
      -image: circleci/ruby:2.4
     steps: 
      - run: echo "rails build" 
    
    

workflows:
  version: 2.1
  develop_workflow:
    jobs:
      - rails_build:
          filters:
            branches:
              ignore:
                - master
      - rails_test:
          requires:
            - rails_build
  production_workflow:
    jobs:
      - rails_build:
          filters:
            branches:
              only: master
      - rails_test:
          parallelism: 4
          requires:
            - rails_build

       
